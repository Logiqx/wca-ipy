function debugMessage(c,b){var a="";a+="<h2>Houston, we have a problem</h2>";a+="<h3>Browser</h3><p>You need at least Chrome 1, Firefox 4, IE8, Safari 4 or Opera 10</p>";a+="<h3>Debug</h3><p>"+c+": "+b+"</p>";return a}function parameterMessage(c,b){var a="";a+="<h2>Hello, I'm Sorry...</h2>";a+="<p>Unrecognised "+c+" specified in the URL - "+b+"</p>";return a}function header(){var a="";if(getViewportWidth()<IPHONE_LANDSCAPE){a+="<p>Tip: Best viewed in landscape mode on mobile phones and some tablets.</p>"}return a}function footer(){var a="";return a}var IPAD_LANDSCAPE=1024;var IPAD_PORTRAIT=768;var GALAXY_S3_LANDSCAPE=640;var GALAXY_S3_PORTRAIT=360;var IPHONE_LANDSCAPE=480;var IPHONE_PORTRAIT=320;function getViewportWidth(){return document.documentElement.clientWidth}function getViewportHeight(){return document.documentElement.clientHeight}var eventIds=[];var personIds=[];var countryIds=[];function getEventIds(){if(eventIds.length==0){for(var a=0;a<rankings.events.length;a++){eventIds.push(rankings.events[a].id)}}return eventIds}function getPersonIds(){if(personIds.length==0){for(var a=0;a<rankings.persons.length;a++){personIds.push(rankings.persons[a].id)}}return personIds}function getCountryIds(){if(countryIds.length==0){for(var a=0;a<rankings.countries.length;a++){countryIds.push(rankings.countries[a].id)}}return countryIds}function getResultTypes(){var b=[];for(var e=0;e<rankings.events.length;e++){var d=rankings.events[e];for(var c=0;c<d.rankings.length;c++){var a=d.rankings[c];if(b.indexOf(a.type)<0){b.push(a.type)}}}if(b.indexOf("average")>=0&&b.indexOf("single")>=0){b=["single","average"]}return b}function addEventHandler(d,b,c){var a="on"+b;if(b=="hashchange"&&!(a in d)){hashChangeFallback(d,c)}else{if(d.addEventListener){d.addEventListener(b,c,false)}else{if(d.attachEvent){d.attachEvent(a,c)}}}}function hashChangeFallback(b,a){b.onhashchange=a;(function(e){var c=e.location,d=c.href,f=c.hash;setInterval(function(){var h=c.href,g=c.hash;if(g!=f&&typeof e.onhashchange==="function"){e.onhashchange({type:"hashchange",oldURL:d,newURL:h});d=h;f=g}},100)})(window)}var lastHash="n/a";var lastWidth=getViewportWidth();function renderPage(e){try{var d=false;if(e!=lastHash){d=true}else{if(e=="random"){d=true}}var a=getViewportWidth();if(a!=lastWidth){d=true}if(d){var f=e.substring(1).split("-");if(f[0].length==0||getEventIds().indexOf(f[0])>=0){renderRankings(f,a)}else{if(f[0]=="random"||getPersonIds().indexOf(f[0])>=0){renderPerson(f,a)}else{var c=parameterMessage("event or person",f[0]);document.getElementById("container").innerHTML=c}}lastHash=e;lastWidth=a}}catch(b){var c=debugMessage("renderPage",b.message);document.getElementById("container").innerHTML=c}}function hashChangeHandler(){try{var c=window.location.hash;renderPage(c)}catch(b){var a=debugMessage("hashChangeHandler",b.message);document.getElementById("container").innerHTML=a}}function resizeHandler(){try{var c=lastHash;renderPage(c)}catch(b){var a=debugMessage("resizeHandler",b.message);document.getElementById("container").innerHTML=a}}function popStateHandler(d){try{if(d.state!=null){var c=d.state.hash;renderPage(c);setTimeout(function(){window.scrollTo(d.state.xOffset,d.state.yOffset)},1)}else{var c=window.location.hash;renderPage(c)}}catch(b){var a=debugMessage("popStateHandler",b.message);document.getElementById("container").innerHTML=a}}function polyfillIndexOf(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){var b;if(this==null){throw new TypeError('"this" is null or not defined')}var e=Object(this);var a=e.length>>>0;if(a===0){return -1}var f=d|0;if(f>=a){return -1}b=Math.max(f>=0?f:a-Math.abs(f),0);while(b<a){if(b in e&&e[b]===c){return b}b++}return -1}}}function loadHandler(){try{polyfillIndexOf();addEventHandler(window,"hashchange",hashChangeHandler);addEventHandler(window,"resize",resizeHandler);addEventHandler(window,"popstate",popStateHandler);hashChangeHandler()}catch(b){var a=debugMessage("loadHandler",b.message);document.getElementById("container").innerHTML=a}}function storeWindowOffset(){try{var c={hash:lastHash,xOffset:window.pageXOffset,yOffset:window.pageYOffset};var d=document.title;var a=window.location.href;history.replaceState(c,d,a)}catch(b){}}function switchView(){storeWindowOffset();var a=document.getElementById("eventId");var b=a.options[a.selectedIndex].value;var i=document.getElementById("resultType");var f=i.options[i.selectedIndex].value;var k=document.getElementById("ageCategory");var e=k.options[k.selectedIndex].value;var g="#";if(e>40){g+=b+"-"+f+"-"+e}else{if(f!=getResultTypes()[0]){g+=b+"-"+f}else{g+=b}}try{if(navigator.userAgent.indexOf("Chrome/5.0")>-1){throw"Chrome/5.0"}var h={hash:g,xOffset:window.pageXOffset,yOffset:window.pageYOffset};var j=rankings.events[eventIds.indexOf(b)]+" - "+selectElement.options[selectElement.selectedIndex].text;var c=g;history.pushState(h,j,c);renderPage(g)}catch(d){window.location.hash=g}}addEventHandler(window,"load",loadHandler);function renderPerson(e,c){var b="";var a=getPersonIds();if(e[0]=="random"){personId=a[Math.floor(Math.random()*a.length)]}else{personId=e[0]}if(a.indexOf(personId)>=0){var d=rankings.persons[a.indexOf(personId)];b+="<h2>"+d.name+"</h2>";document.title=d.name;b+=e;b+=header();b+=footer()}else{b+=parameterMessage("person",personId)}document.getElementById("container").innerHTML=b};function renderOptions(a,f,c,b){var d="";if(b>=GALAXY_S3_PORTRAIT){d+='<div class="dropdowns"><p><table><tr><th>Event:</th><th>Result:</th><th>Age:</th></tr><tr>'}var e=filterEventIds(f,c);if(b<GALAXY_S3_PORTRAIT){d+='<div class="dropdowns"><table><tr><th>Event:</th>'}d+='<td><select id="eventId" onChange="switchView()">';for(var l=0;l<e.length;l++){var h=rankings.events[getEventIds().indexOf(e[l])];d+='<option value="'+h.id+'"';if(h.id==a){d+=" selected"}d+=">"+h.name+"</option>"}d+="</select></td>";var j=filterResultTypes(a,c);if(b<GALAXY_S3_PORTRAIT){d+="</tr><tr><th>Result:</th>"}d+='<td><select id="resultType" onChange="switchView()">';for(var g=0;g<j.length;g++){d+='<option value="'+j[g]+'"';if(j[g]==f){d+=" selected"}d+=">"+j[g].charAt(0).toUpperCase()+j[g].slice(1)+"</option>"}d+="</select></td>";var k=filterAgeCategories(a,f);if(b<GALAXY_S3_PORTRAIT){d+="</tr><tr><th>Age:</th>"}d+='<td><select id="ageCategory" onChange="switchView()">';for(var g=0;g<k.length;g++){d+='<option value="'+k[g]+'"';if(k[g]==c){d+=" selected"}d+=">Over "+k[g]+"</option>"}d+="</select></td></tr></table></p></div>";return d}function filterEventIds(b,d){var e=[];for(var g=0;g<rankings.events.length;g++){var f=rankings.events[g];for(var c=0;c<rankings.events[g].rankings.length;c++){var a=rankings.events[g].rankings[c];if(a.type==b&&a.age==d&&e.indexOf(f.id)<0){e.push(f.id)}}}return e}function filterResultTypes(e,d){var b=[];var f=rankings.events[getEventIds().indexOf(e)];for(var c=0;c<f.rankings.length;c++){var a=f.rankings[c];if(a.age==d&&b.indexOf(a.type)<0){b.push(a.type)}}if(b.indexOf("average")>=0&&b.indexOf("single")>=0){b=["single","average"]}return b}function filterAgeCategories(e,b){var c=[];var f=rankings.events[getEventIds().indexOf(e)];for(var d=0;d<f.rankings.length;d++){var a=f.rankings[d];if(a.type==b&&c.indexOf(a.age)<0){c.push(a.age)}}return c}function renderTable(a,i,g,c){var h="";var d=getPersonIds();var j=getCountryIds();var m=rankings.events[getEventIds().indexOf(a)];for(var n=0;n<m.rankings.length;n++){var f=m.rankings[n];if(f.type==i&&f.age==g){h+='<div class="rankings"><table>';h+="<tr>";h+='<th class="rank">Rank</th>';h+="<th>Person</th>";if(c>=IPHONE_LANDSCAPE){h+="<th>Country</th>"}h+="<th>Result</th>";h+="</tr>";var e=0;for(var p=0;p<f.ranks.length;p++){var l=f.ranks[p];var k=rankings.persons[d.indexOf(l.id)];var o=rankings.countries[j.indexOf(k.country)];h+="<tr>";h+='<td class="rank">'+(l.rank>e?l.rank:"")+"</td>";var b='<a href="https://www.worldcubeassociation.org/persons/'+l.id+"?event="+a+'">'+k.name+"</a>";if(c>=IPHONE_LANDSCAPE){h+="<td>"+b+(l.hasOwnProperty("age")?", "+l.age+"+":"")+"</td>";h+="<td>"+o.name+"</td>"}else{h+="<td>"+b+", "+o.name+(l.hasOwnProperty("age")?", "+l.age+"+":"")+"</td>"}h+='<td class="result">'+l.best+"</td>";h+="</tr>";e=l.rank}h+="</table></div>"}}return h}function renderRankings(h,f){var c="";var d=getEventIds();var e=h[0].length>0?h[0]:d[0];var a=h.length>1&&h[1].length>0?h[1]:getResultTypes()[0];var b=h.length>2&&h[2].length>0?h[2]:"40";if(d.indexOf(e)>=0){var g=rankings.events[d.indexOf(e)];document.title=g.name+" - Over "+b+"s";c+=header();c+=renderOptions(e,a,b,f);c+=renderTable(e,a,b,f);c+=footer()}else{c+=parameterMessage("event",e)}document.getElementById("title").innerHTML=document.title;document.getElementById("refreshed").innerHTML=rankings.refreshed;document.getElementById("container").innerHTML=c};